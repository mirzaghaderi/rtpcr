<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cleaning data and weighted delta Ct (wDCt) calculation — compute_wDCt • rtpcr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cleaning data and weighted delta Ct (wDCt) calculation — compute_wDCt"><meta name="description" content="The compute_wDCt function cleans the data and computes wDCt. This function is
automatically applied to the expression analysis functions like ANOVA_DDCt,
TTEST_DDCt, etc. So it should not be applied in advance of expression analysis functions."><meta property="og:description" content="The compute_wDCt function cleans the data and computes wDCt. This function is
automatically applied to the expression analysis functions like ANOVA_DDCt,
TTEST_DDCt, etc. So it should not be applied in advance of expression analysis functions."><meta property="og:image" content="https://mirzaghaderi.github.io/rtpcr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtpcr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Manual.html">Manual</a></li>
    <li><a class="dropdown-item" href="../articles/Method.html">Calculation method</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mirzaghaderi/rtpcr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cleaning data and weighted delta Ct (wDCt) calculation</h1>
      <small class="dont-index">Source: <a href="https://github.com/mirzaghaderi/rtpcr/blob/HEAD/R/compute_wDCt.R" class="external-link"><code>R/compute_wDCt.R</code></a></small>
      <div class="d-none name"><code>compute_wDCt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>compute_wDCt</code> function cleans the data and computes wDCt. This function is
automatically applied to the expression analysis functions like <code>ANOVA_DDCt</code>,
<code>TTEST_DDCt</code>, etc. So it should not be applied in advance of expression analysis functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compute_wDCt</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">numOfFactors</span>,</span>
<span>  <span class="va">numberOfrefGenes</span>,</span>
<span>  <span class="va">block</span>,</span>
<span>  set_missing_target_Ct_to_40 <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A data frame containing experimental design columns, replicates (integer), target gene
E/Ct column pairs, and reference gene E/Ct column pairs. Reference gene
columns must be located at the end of the data frame.</p></dd>


<dt id="arg-numoffactors">numOfFactors<a class="anchor" aria-label="anchor" href="#arg-numoffactors"></a></dt>
<dd><p>Integer. Number of experimental factor columns
(excluding <code>rep</code> and optional <code>block</code>).</p></dd>


<dt id="arg-numberofrefgenes">numberOfrefGenes<a class="anchor" aria-label="anchor" href="#arg-numberofrefgenes"></a></dt>
<dd><p>Integer. Number of reference genes.</p></dd>


<dt id="arg-block">block<a class="anchor" aria-label="anchor" href="#arg-block"></a></dt>
<dd><p>Character or <code>NULL</code>. Name of the blocking factor column.
When a qPCR experiment is done in multiple qPCR plates, each plate is considered as a random block
so that at least one replicate of each treatment and control is present
on a plate.</p></dd>


<dt id="arg-set-missing-target-ct-to-">set_missing_target_Ct_to_40<a class="anchor" aria-label="anchor" href="#arg-set-missing-target-ct-to-"></a></dt>
<dd><p>If <code>TRUE</code>, missing target gene Ct
values become 40; if <code>FALSE</code> (default), they become NA.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The original data frame along with the weighted delta Ct column.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>compute_wDCt</code> function computes weighted delta Ct (wDCt) for the input data.
Missing data can be denoted by NA in the input data frame.
Values such as '0' and 'undetermined' (for any E and Ct) are
automatically converted to NA. For target genes, NA for E or Ct measurements cause returning NA for
the corresponding delta Ct for that replicate (row).
If there are more than one reference gene, NA in the place of the E or the Ct value cause
skipping that gene and remaining references are geometrically averaged.
The <code>compute_wDCt</code> function is automatically applied to the expression analysis
functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>           </span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data_2factorBlock3ref.csv"</span>, package <span class="op">=</span> <span class="st">"rtpcr"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Type Concentration block Rep   PO        Ct_PO NLM       Ct_NLM ref1 Ct_ref1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     R            L1     1   1 1.88         33.3 1.9        28.77 1.75   31.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     R            L1     1   2 1.88        33.39 1.9         28.2 1.75   31.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     R            L1     2   3 1.88        33.34 1.9        28.48 1.75   31.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     R            L1     2   4 1.88        33.34 1.9        28.64 1.75   30.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     R            L2     1   1 1.88        32.73 1.9        31.17 1.75   31.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     R            L2     1   2 1.88 undetermined 1.9        31.05 1.75   32.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     R            L2     2   3 1.88         32.6 1.9        31.42 1.75   31.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     R            L2     2   4 1.88        32.15 1.9         31.4 1.75   30.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     R            L3     1   1 1.88        31.48 1.9        30.19 1.75   33.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    R            L3     1   2 1.88        31.27 1.9 undetermined 1.75   33.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    R            L3     2   3 1.88        31.32 1.9        30.22 1.75   33.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    R            L3     2   4 1.88        31.32 1.9         30.4 1.75   29.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    S            L1     1   1 1.88        32.85 1.9        32.26 1.75   26.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    S            L1     1   2 1.88        32.17 1.9        32.85 1.75   27.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    S            L1     2   3 1.88        32.99 1.9        32.55 1.75   27.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    S            L1     2   4 1.88        32.89 1.9        32.75 1.75   27.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    S            L2     1   1 1.88        32.41 1.9        32.97 1.75   28.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    S            L2     1   2 1.88        32.49 1.9        32.83 1.75   28.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    S            L2     2   3 1.88 undetermined 1.9         32.6 1.75   28.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    S            L2     2   4 1.88         32.3 1.9        32.33 1.75   28.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    S            L3     1   1 1.88        31.03 1.9         29.4 1.75   30.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    S            L3     1   2 1.88        31.73 1.9        29.76 1.75   30.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    S            L3     2   3 1.88        31.83 1.9        29.22 1.75   30.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    S            L3     2   4 1.88        31.83 1.9        29.15 1.75   29.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ref2 Ct_ref2 ref3      Ct_ref3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2   30.81    2        27.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2   30.71    2        27.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2   30.03    2        27.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2   30.03    2         27.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2   29.91    2         27.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2   30.05    2         27.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     2   29.99    2        28.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     2   30.55    2         28.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     2   30.10    2         27.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    2   30.17    2        28.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    2   30.51    2        29.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    2   30.51    2        29.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    2   30.73    2         27.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    2   30.68    2        27.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    2   30.00    2 undetermined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    2   30.71    2        27.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    2   30.58    2         28.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    2   30.03    2        28.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    2   31.06    2        28.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    2   31.06    2        27.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    2   31.14    2        27.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    2   30.24    2        27.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    2   30.11    2        28.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    2   30.11    2        27.24</span>
<span class="r-in"><span><span class="fu">compute_wDCt</span><span class="op">(</span>x <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>             numOfFactors <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>             numberOfrefGenes <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>             block <span class="op">=</span> <span class="st">"block"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Type Concentration block Rep   PO Ct_PO NLM Ct_NLM ref1 Ct_ref1 ref2 Ct_ref2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     R            L1     1   1 1.88 33.30 1.9  28.77 1.75   31.53    2   30.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     R            L1     1   2 1.88 33.39 1.9  28.20 1.75   31.57    2   30.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     R            L1     2   3 1.88 33.34 1.9  28.48 1.75   31.50    2   30.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     R            L1     2   4 1.88 33.34 1.9  28.64 1.75   30.50    2   30.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     R            L2     1   1 1.88 32.73 1.9  31.17 1.75   31.30    2   29.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     R            L2     1   2 1.88    NA 1.9  31.05 1.75   32.55    2   30.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     R            L2     2   3 1.88 32.60 1.9  31.42 1.75   31.92    2   29.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     R            L2     2   4 1.88 32.15 1.9  31.40 1.75   30.81    2   30.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     R            L3     1   1 1.88 31.48 1.9  30.19 1.75   33.30    2   30.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    R            L3     1   2 1.88 31.27 1.9     NA 1.75   33.37    2   30.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    R            L3     2   3 1.88 31.32 1.9  30.22 1.75   33.35    2   30.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    R            L3     2   4 1.88 31.32 1.9  30.40 1.75   29.35    2   30.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    S            L1     1   1 1.88 32.85 1.9  32.26 1.75   26.94    2   30.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    S            L1     1   2 1.88 32.17 1.9  32.85 1.75   27.69    2   30.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    S            L1     2   3 1.88 32.99 1.9  32.55 1.75   27.34    2   30.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    S            L1     2   4 1.88 32.89 1.9  32.75 1.75   27.36    2   30.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    S            L2     1   1 1.88 32.41 1.9  32.97 1.75   28.70    2   30.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    S            L2     1   2 1.88 32.49 1.9  32.83 1.75   28.66    2   30.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    S            L2     2   3 1.88    NA 1.9  32.60 1.75   28.71    2   31.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    S            L2     2   4 1.88 32.30 1.9  32.33 1.75   28.72    2   31.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    S            L3     1   1 1.88 31.03 1.9  29.40 1.75   30.61    2   31.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    S            L3     1   2 1.88 31.73 1.9  29.76 1.75   30.20    2   30.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    S            L3     2   3 1.88 31.83 1.9  29.22 1.75   30.49    2   30.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    S            L3     2   4 1.88 31.83 1.9  29.15 1.75   29.34    2   30.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ref3 Ct_ref3        wDCt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2   27.01 -1.16612574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2   27.17 -1.73033264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2   27.53 -1.36500151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2   27.90 -1.04254847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2   27.60  1.19827424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2   27.30  0.78209047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     2   28.46  0.93696586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     2   28.40  1.09624592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     2   27.70 -0.38014430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    2   28.14          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    2   29.61 -1.13474523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    2   29.51  0.27745548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    2   27.70  3.28655511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    2   27.68  3.60944806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    2      NA  3.34120975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    2   27.11  3.79970050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    2   28.70  3.09910490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    2   28.92  3.07813001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    2   28.43  2.69725429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    2   27.43  2.77025159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    2   27.42 -0.54668179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    2   27.81  0.05099101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    2   28.29 -0.65484402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    2   27.24 -0.02400916</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ghader Mirzaghaderi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

